# 철도 유휴부지DB를 이용한 레일스테이부지 추천: 수요계층과 사용자 요구사항 반영

# Description:

“철도 유휴부지”란 철도 폐선부지와 철도부지 중 철도 운영 이외의 용도로 사용하더라도 철도운영 및 안전에 지장을 주지 않는 부지를 뜻한다. 현재, 철도 유휴부지 활용사업은 산책로 혹은 공원으로 한정 되어있으나, 상업시설 설치를 통해서 수익창출을 이루어낸다면 유휴부지 사용료의 부담도 덜어내고 유휴부지를 다양하게 활용함으로서 발생하는 긍정적 효과를 기대할 수 있다. 폐선로 부지의 활용방안으로는 그 지역적 특성에 따라서 여러가지가 있는데, 우리는 최근 1인가구의 꾸준한 증가나 전세사기, 주거세부담 등 청년들에게 일어나는 사회적 문제를 고려해보기로 하였다. 해당 사회적 문제 해결방안으로 청년 임대주택 문제와 철도 유휴부지문제를 조합해보고자 하였다. 

 이번 프로젝트를 통해 계층(대학생, 사회초년생, 신혼부부 등) 별 요구되는 주택수요의 특성을 반영하여 폐철도 유휴부지 중에서 지리, 환경적 이점에 있는 곳에 해당 철도 유휴부지를 활용한 ‘레일 스테이’ 와 같은 복합문화공간을 건설하기 좋은 위치를 추천해보고자 한다.

해당 서비스는 청년임대 주택 입지 선정을 결정하는 정부 관리자가 활용을 할 수 있을 것이다. 사용자가 레일 스테이를 짓고 싶은 철도 유휴부지의 면적, 노선명, 청년 계층을 입력하면 조건을 만족하는 추천 유휴부지 위치를 선정할 수 있도록 DB를 설계하였다.

## 요구 사항:

1. 사용자는 사용자 ID, 비밀번호, 이름, 이메일, 요구노선, 요구 면적, 계층, 연락처를 입력해야 한다. 
2. 사용자는 사용자 ID로 식별한다.
3. 철도 유휴부지에 대한 행정동 ID, 주소명, 노선명, 면적, 지역 본부, 사용 여부, 사용현황, 사용계획, 비고, 행정동, 행정동 코드 정보를 유지해야 한다.
4. 철도 유휴부지는 주소로 식별한다.
5. 사용자는 여러 철도 유휴부지를 추천받을 수 있고, 하나의 철도 유휴부지는 여러 사용자에게 추천될 수 있다.
6. 사용자가 철도 유휴부지를 추천받으면 추천에 대한 사용자 ID, 주소(철도 유휴부지), 추천 점수 정보를 유지해야 한다.
7. 각 철도 유휴부지는 하나의 행정동에 속해 있고, 행정동은
여러 철도 유휴부지를 소유하고 있다.
8. 행정동에 대한 행정동 코드, 행정동, 공공기관, 관광명소, 대형마트, 약국, 어린이집, 은행, 음식점, 주유소, 주차장, 중개업소, 카페, 편의점, 학교, 학원, 숙박, 문화시설, 병원, 지하철역, 체육시설 수, 인구수, 경찰서 수 정보를 유지해야 한다.
9. 행정동은 행정동 ID로 식별한다.
10. 계층별 가중치는 계층, 유효상권, 가중치 정보를 유지해야 한다.
11. 계층은 계층과 유효상권으로 식별한다.
12. 한 명의 사용자는 하나의 계층에 해당하고, 하나의 계층은 여러 사용자에게 해당할 수 있다.

## 개념적 설계:

### ER Diagram:

ER Diagram

<img width="628" alt="스크린샷 2023-12-28 오후 5 46 52" src="https://github.com/edjjincode/Location_Selection/assets/138580800/3e26ed4f-e5a6-494e-baae-34afa63e7fdf">

### 논리적 설계:

### 규칙 1: 모든 개체는 릴레이션으로 변환한다

<img width="628" alt="스크린샷 2023-12-28 오후 5 56 33" src="https://github.com/edjjincode/Location_Selection/assets/138580800/8477e9e6-569a-4544-9010-c06af7ab5a1a">

<img width="611" alt="스크린샷 2023-12-28 오후 5 57 06" src="https://github.com/edjjincode/Location_Selection/assets/138580800/b7f8528d-0653-4517-8ace-c15099ed5c80">

<img width="594" alt="스크린샷 2023-12-28 오후 6 06 59" src="https://github.com/edjjincode/Location_Selection/assets/138580800/40827a7c-0f8d-45aa-82ec-be50df82121b">


### 규칙 2: 다대다 N:M 관계는 릴레이션으로 변환한다

<img width="569" alt="스크린샷 2023-12-28 ß오후 5 57 34" src="https://github.com/edjjincode/Location_Selection/assets/138580800/8cfde59c-2939-4d72-83b1-594de08ef213">

<img width="575" alt="스크린샷 2023-12-28 오후 5 57 59" src="https://github.com/edjjincode/Location_Selection/assets/138580800/66ba34fe-dbe2-45cb-b690-0557bc5eb62c">

### 규칙 3: 일대다 1:N 관계는 외래키로 표현한다

<img width="501" alt="스크린샷 2023-12-28 오후 6 13 57" src="https://github.com/edjjincode/Location_Selection/assets/138580800/5e5d66a8-e7a3-42ce-a288-4b6b832840cf">

<img width="488" alt="스크린샷 2023-12-28 오후 6 14 15" src="https://github.com/edjjincode/Location_Selection/assets/138580800/d3fb7a02-20ea-46fd-bd7d-68479af3c2ef">

<img width="599" alt="스크린샷 2023-12-28 오후 6 14 42" src="https://github.com/edjjincode/Location_Selection/assets/138580800/feb0bceb-24c9-4175-a9e9-6174f7c929c1">

### DB 구현:

mySQL Workbench 환경에서 SQL 쿼리를 작성하였고, DB를 구축하였다.

1. 사용자 테이블

<img width="418" alt="스크린샷 2023-12-28 오후 6 33 15" src="https://github.com/edjjincode/Location_Selection/assets/138580800/d04d27a0-538c-49d2-895c-66ba44e7449d">

2. 철도유휴부지 테이블

<img width="533" alt="스크린샷 2023-12-28 오후 6 33 47" src="https://github.com/edjjincode/Location_Selection/assets/138580800/96b5c1d2-a87b-4fe9-82ae-e36594405c3e">

3. 행정동 상권 테이블

<img width="434" alt="스크린샷 2023-12-28 오후 6 34 05" src="https://github.com/edjjincode/Location_Selection/assets/138580800/5d206ecb-d7e9-4f3e-8b73-1a12d00d1a62">

4. 추천 테이블

<img width="565" alt="스크린샷 2023-12-28 오후 6 34 24" src="https://github.com/edjjincode/Location_Selection/assets/138580800/0a7ee1a5-5880-4a64-8c58-853c537266f5">

5. 계층 테이블

<img width="382" alt="스크린샷 2023-12-28 오후 6 34 54" src="https://github.com/edjjincode/Location_Selection/assets/138580800/598cbe57-13fb-442c-923b-c1b94d8e22b8">

6. ERD-Diagram

<img width="597" alt="스크린샷 2023-12-28 오후 6 35 23" src="https://github.com/edjjincode/Location_Selection/assets/138580800/b4632a8e-b101-4b55-937a-e8dcfce1ef20">

## 데이터 분석:

1. 목표:

레일 스테이 입지 선정을 위한 입지 선정 지수를 만드는 것을 목표로 하였다. 레일스테이는 철도 유휴부지를 활용한 청년임대주택임으로 청년임대 주택에 영향을 주는 요인들이 레일 스테이 입지 선정에도 영향을 주는 요인이라고 판단하였다. 따라서 머신러닝 알고리즘을 통해 청년임대 주택에 영향을 주는 변수들의 영향력을 가중치라고 판단하여 하나의 선형 식을 구한 후, 그것을 레일 스테이 데이터 셋에 적용하는 방식으로 접근하였다.
더 정확한 결과 값을 구하기 위해서 비지도 학습 방식으로 군집을 만든 후, 청년 임대 주택의 대표인자와 연관성이 없는 군집을 제거하려고 한다. 청년 임대 주택의 대표 인자 같은 경우 세대 수를 종속 변수로 놓고 나머지 인자들을 독립변수로 놓은 후 OLS 선형회귀를 돌려 	상관계수 값이 가장 큰 두 인자를 대표인자로 선정하였다. 



2. 전처리:

상권 데이터는 청년임대주택의 주소 값을 기준으로 구했지만 경찰서, 체육시설, 인구 수 데이터는 행정동을 기준으로 존재한다. 서로 다른 기준을 가지고 있기 때문에 주소 값을 기준으로 되어있는 상권데이터를 행정동 단위로 합치는 작업을 진행했다. 청년임대주택 세대 수 또한 주소 값을 기준으로 되어있기 때문에 행정동 단위로 합치는 작업을 진행했다.

3. 선형성 확인:

비지도학습 군집화를 진행하기 앞서 군집 분석을 해석하기 용이하게 대표 두 인자를 뽑는 과정을 거쳤다. 세대수를 종속 변수로 놓고 나머지 인자들을 독립 변수로 놓아 OLS 선형회귀를 돌린 결과 Prob(F-static)의 값이 0.05보다 작아 유의함을 확인할 수 있었다. 즉, y값 세대 수에 대해 나머지 인자들이 선형적 관계에 있다는 것이다. 종속 변수 세대 수에 가장 영향력이 있는 대표 인자를 뽑기 위해서는 상관 관계계수 값이 가장 큰 두 인자를 뽑으면 되지만 그 전에 독립 변수간에 다중 공선성을 확인할 필요가 있다. 다중 공선성은 독립변수들 간에 강한 상관관계가 나타나는 지표이다. 다중 공선성이 존재하면 변수들 간의 설명력이 낮아지는 효과가 생겨 데이터 분석에 용이하지 않다. 특히 상관관계 계수를 통해 대표인자를 뽑을 때는 다중공선성을 필히 제거해야 한다. 따라서 OLS 선형회귀 분석을 진행하기 전 다중 공선성이 존재하는지 확인하고 다중 공선성이 존재하면 순차적으로 VIF 값이 가장 큰 변수를 없애는 과정을 진행하였다. VIF는 다중공선성을 확인할 수 있는 대표적인 지표이다. 모든 변수들의 VIF값이 10이하가 될 때까지 VIF값이 10이상인 인자를 제거하는 과정을 거쳤다.  

<img width="170" alt="스크린샷 2023-12-28 오후 6 51 33" src="https://github.com/edjjincode/Location_Selection/assets/138580800/7cbd3879-4594-49ac-b7bd-834dcf940d11">

<img width="352" alt="스크린샷 2023-12-28 오후 7 04 27" src="https://github.com/edjjincode/Location_Selection/assets/138580800/1cc65436-f13f-4df3-8b0e-be736d2a9e9c">

4. 대표 인자 추출

앞서 진행한 결과로 데이터가 선형성을 띄움을 알 수 있고 대표인자를 추출하기 위해 선형 함수에서 상관계수가 가장 큰 두 인자를 추출했다. 보통은 대표인자를 추출할 때 비선형 회귀 모델인 Feature Importance를 사용하지만 데이터가 선형성을 띄어 상관계수로 대표 인자를 추출했다. 해당 인자는 대형마트, 역세권이 됐고 대형마트가 많고 역세권에 가까울수록 청년임대주택에 영향을 많이 준다고 판단했다. 

5. 이상치 제거

데이터를 군집화 하여 대표인자와 관련이 없는 군집을 제거하는 과정을 거쳤다. 다양한 군집화 알고리즘 중 최적의 군집 알고리즘을 구하기 위해 데이터의 분포를 확인하는 과정을 거쳤다. 다음은 Pairplot을 구한 결과이다.

<img width="384" alt="스크린샷 2023-12-29 오후 7 07 13" src="https://github.com/edjjincode/Location_Selection/assets/138580800/ee804d0d-c826-4160-a122-77e45291b269">


Pairplot을 보면 인자들 간 선형성을 띄며 기하학적인 분포를 띈다는 것을 알 수 있다. 이러한 데이터 분포의 특성을 반영하여 다양한 군집 알고리즘 중 GMM 모델을 선택하였다. GMM 모델은 데이터가 여러 다른 모양의 가우시안 분포로 결합되어 있다는 가정 하에 개별 데이터를 동일한 가우시안 분포별로 묶어주는 비지도 학습 알고리즘으로 가우시안 분포의 군집에 대해서 군집화를 잘한다는 특징이 있다. 

<img width="358" alt="스크린샷 2023-12-29 오후 7 07 35" src="https://github.com/edjjincode/Location_Selection/assets/138580800/eebb3337-3490-4234-bd95-ca384f931c7e">

클러스터 개수를 구하기 위해 silhouette계수를 사용했다.

<img width="548" alt="스크린샷 2023-12-29 오후 7 08 05" src="https://github.com/edjjincode/Location_Selection/assets/138580800/19e436dc-321b-426e-95ef-623e986626f7">

다음은 실루엣 계수를 시각화한 자료이다.

<img width="237" alt="스크린샷 2023-12-29 오후 7 08 33" src="https://github.com/edjjincode/Location_Selection/assets/138580800/2815e4b5-3f69-4ef7-a5ef-04d02537845d">


6. 입지선정 스코어 생성:

입지선정 스코어를 만들 때 PCA모델을 사용했다. PCA loading은 주성분 혹은 요인들이 한 변수를 정의하는 가중치를 뜻한다. PVE는 주성분들의 설명되는 분산 비율을 뜻한다. 만일 PC1의 PVE가 충분히 높다면 PC1의 loading 값을 평가지표의 가중치로 사용 가능하다. 이 가중치를 활용해 가중치 테이블을 생성한다. Feature들의 크기가 모두 다르기 때문에 이를 동일한 크기로 비교하기 위해 MinMax Scaling을 활용하여 모두 균등한 크기로 만든다. MinMax Scaling은 최소값을 0. 최대값을 1로 변환하는 Scaling 기법이다. 계층별로 feature의 값이 다르기 때문에 각 방법을 계층별로 반복해 진행한다. 

<img width="590" alt="스크린샷 2023-12-30 오후 4 27 06" src="https://github.com/edjjincode/Location_Selection/assets/138580800/5a2181e5-f447-46a0-aa69-8db1e7163821">

<img width="590" alt="스크린샷 2023-12-30 오후 4 27 25" src="https://github.com/edjjincode/Location_Selection/assets/138580800/13cf6163-b46d-46bb-9afe-889ba7e083e5">

## 결론:

### 입지선정 지수 평가:

데이터 분석을 통해 구한 계층별 입지 선정 지수(가중치)가 유의미한 결과를 도출하는 지 평가하는 과정을 거쳤다. 각 계층을 입력했을 때 출력되는 상위 유휴부지 주소 값을 기준으로 Kakao Api를 돌려 반경 500m에 있는 상권 수를 확인하였다. 만일 생성한 지수가 유의미하다면, 각 생성한 지수의 상권의 가중치에 비례하게 유휴부지 주변 상권 수가 있을 것이다. 따라서 입지선정 지수를 평가하기 위해 다음과 같은 과정을 거쳤다.

1. 뽑고자 하는 계층을 가진 사용자 데이터를 퀴리 문에 넣어 추천점수가 높은 유휴부지 주소를 출력하였다.
2. 출력된 유휴부지 주소를 기준으로 Kakap Api를 돌려 반경 500m 내에 있는 상권 수를 구하였다.
3. 유휴부지 반경에 있는 상권 수가 해당 계층의 입지 선정 지수와 비례하는 지 확인하였다.

### 1. 대학생 계층의 입지 선정 지수가 적절한지 확인하였다.

<img width="561" alt="스크린샷 2023-12-30 오후 4 36 09" src="https://github.com/edjjincode/Location_Selection/assets/138580800/ee4d2871-c8b2-40f0-8c5c-3a0a31ed7f88">


**평가**

대학생의 입지선정 지수에서 가장 큰 가중치를 가지는 인자들은 편의점, 카페, 음식점이다. 위 데이터를 확인하면 대학생의 경우 주요 인자가 편의점, 카페, 음식점인데 추천된 철도 유휴부지의 상권데이터의 편의점, 카페, 음식점의 수치가 다른 변수들에 비해 높음을 확인할 수 있다.

### 2. 사회초년생 계층의 입지 선정 지수가 적절한지 확인하였다.

<img width="564" alt="스크린샷 2023-12-30 오후 4 46 06" src="https://github.com/edjjincode/Location_Selection/assets/138580800/5efe4deb-ecb1-46dd-b4d5-54a037db7ae6">

**평가**

사회초년생의 입지선정 지수에서 가장 큰 가중치를 가지는 주차장, 카페, 중개업소 인자들이다. 위 데이터를 확인하면 사회초년생의 경우 주요 인자가 주차장, 카페, 중개업소인데 추천된 철도 유휴부지의 상권데이터의 주차장, 카페, 중개업소의 수치가 다른 변수들에 비해 높음을 확인할 수 있다. 


# Environment

# Files

```
|---data_analysis.ipynb
|---processing.ipynb
```














